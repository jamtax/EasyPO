<!DOCTYPE html>
<html lang="en-ZA">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="icon.png" type="image/png">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <title>Easy Payroll – Pro</title>
  <meta name="description" content="Professional payroll calculator with earnings, deductions, PAYE, UIF and net pay calculation.">

  <!-- Tailwind -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">

  <style>
    @media print {
      body * {
        visibility: hidden;
      }
      #printArea, #printArea * {
        visibility: visible;
      }
      #printArea {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
      }
    }
  </style>
</head>

<body class="bg-gray-100 min-h-screen">

<!-- Navigation -->
<nav class="bg-blue-600 text-white py-4 no-print">
  <div class="container mx-auto px-4 flex flex-wrap items-center gap-4">
    <a href="index.html" class="font-bold text-xl mr-4">Easy&nbsp;Suite</a>
    <a href="easy-quote.html" class="hover:underline">Quote</a>
    <a href="easy-invoice.html" class="hover:underline">Invoice</a>
    <a href="easy-purchase-order.html" class="hover:underline">Purchase&nbsp;Order</a>
    <a href="easy-sales-order.html" class="hover:underline">Sales&nbsp;Order</a>
    <a href="easy-receipt.html" class="hover:underline">Receipt</a>
    <a href="easy-statement.html" class="hover:underline">Statement</a>
    <a href="easy-job-card.html" class="hover:underline">Job&nbsp;Card</a>
    <a href="easy-payroll.html" class="underline font-semibold">Payroll</a>
    <a href="easy-inventory.html" class="hover:underline">Inventory</a>
    <a href="easy-crm.html" class="hover:underline">CRM</a>
  </div>
</nav>

<main class="container mx-auto px-4 py-8">

<h1 class="text-3xl font-bold mb-6 text-gray-800">Easy Payroll – Professional Edition</h1>

<!-- Employee Details -->
<div class="bg-white p-6 rounded shadow mb-6">
  <h2 class="text-xl font-semibold mb-4">Employee Details</h2>
  <div class="grid md:grid-cols-3 gap-4">
    <input id="employeeName" placeholder="Employee Name" class="border p-2 rounded">
    <input id="employeeId" placeholder="Employee ID" class="border p-2 rounded">
    <input id="payPeriod" type="month" class="border p-2 rounded">
  </div>
</div>

<!-- Earnings -->
<div class="bg-white p-6 rounded shadow mb-6">
  <h2 class="text-xl font-semibold mb-4">Earnings</h2>
  <table class="w-full mb-4">
    <thead>
      <tr class="bg-gray-200 text-left">
        <th class="p-2">Description</th>
        <th class="p-2">Amount (R)</th>
        <th class="p-2"></th>
      </tr>
    </thead>
    <tbody id="earningsBody"></tbody>
  </table>
  <button onclick="addRow('earningsBody')" class="bg-blue-600 text-white px-4 py-2 rounded">Add Earning</button>
</div>

<!-- Deductions -->
<div class="bg-white p-6 rounded shadow mb-6">
  <h2 class="text-xl font-semibold mb-4">Deductions</h2>
  <table class="w-full mb-4">
    <thead>
      <tr class="bg-gray-200 text-left">
        <th class="p-2">Description</th>
        <th class="p-2">Amount (R)</th>
        <th class="p-2"></th>
      </tr>
    </thead>
    <tbody id="deductionsBody"></tbody>
  </table>
  <button onclick="addRow('deductionsBody')" class="bg-red-600 text-white px-4 py-2 rounded">Add Deduction</button>
</div>

<!-- Statutory -->
<div class="bg-white p-6 rounded shadow mb-6">
  <h2 class="text-xl font-semibold mb-4">Statutory Deductions (Auto)</h2>
  <div class="grid md:grid-cols-3 gap-4">
    <div>
      <label>PAYE (%)</label>
      <input id="payeRate" type="number" value="18" class="border p-2 rounded w-full">
    </div>
    <div>
      <label>UIF (%)</label>
      <input id="uifRate" type="number" value="1" class="border p-2 rounded w-full">
    </div>
  </div>
</div>

<!-- Summary -->
<div id="printArea" class="bg-white p-6 rounded shadow mb-6">
  <h2 class="text-xl font-semibold mb-4">Payroll Summary</h2>
  <div class="space-y-2 text-lg">
    <div>Gross Pay: R <span id="gross">0.00</span></div>
    <div>Total Deductions: R <span id="totalDeductions">0.00</span></div>
    <div class="font-bold text-green-600">Net Pay: R <span id="netPay">0.00</span></div>
  </div>
</div>

<!-- Buttons -->
<div class="flex flex-wrap gap-4">
  <button onclick="calculatePayroll()" class="bg-green-600 text-white px-6 py-2 rounded">Calculate Payroll</button>
  <button onclick="saveDraft()" class="bg-gray-600 text-white px-6 py-2 rounded">Save Draft</button>
  <button onclick="exportCSV()" class="bg-purple-600 text-white px-6 py-2 rounded">Export CSV</button>
  <button onclick="window.print()" class="bg-black text-white px-6 py-2 rounded">Print Payslip</button>
</div>

</main>

<script>
function addRow(tableId) {
  const table = document.getElementById(tableId);
  const row = document.createElement("tr");
  row.innerHTML = `
    <td class="p-2"><input class="border p-1 w-full"></td>
    <td class="p-2"><input type="number" value="0" class="border p-1 w-full amount"></td>
    <td class="p-2"><button onclick="this.closest('tr').remove()" class="text-red-600">X</button></td>
  `;
  table.appendChild(row);
}

function sumAmounts(selector) {
  let total = 0;
  document.querySelectorAll(selector).forEach(input => {
    total += parseFloat(input.value) || 0;
  });
  return total;
}

function calculatePayroll() {
  const earnings = sumAmounts("#earningsBody .amount");
  const manualDeductions = sumAmounts("#deductionsBody .amount");

  const payeRate = parseFloat(document.getElementById("payeRate").value) || 0;
  const uifRate = parseFloat(document.getElementById("uifRate").value) || 0;

  const paye = earnings * (payeRate / 100);
  const uif = earnings * (uifRate / 100);

  const totalDeductions = manualDeductions + paye + uif;
  const netPay = earnings - totalDeductions;

  document.getElementById("gross").innerText = earnings.toFixed(2);
  document.getElementById("totalDeductions").innerText = totalDeductions.toFixed(2);
  document.getElementById("netPay").innerText = netPay.toFixed(2);
}

function saveDraft() {
  const data = document.body.innerHTML;
  localStorage.setItem("payrollDraft", data);
  alert("Draft saved locally.");
}

function exportCSV() {
  let csv = "Description,Amount\n";
  document.querySelectorAll("#earningsBody tr").forEach(row => {
    const desc = row.cells[0].querySelector("input").value;
    const amount = row.cells[1].querySelector("input").value;
    csv += `${desc},${amount}\n`;
  });
  const blob = new Blob([csv], { type: "text/csv" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "payroll.csv";
  link.click();
}
</script>

</body>
</html>
